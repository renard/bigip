{{- define "rules" }}
{{ "{{- /*" }}
###
### iRules definitions
###
{{ "*/ -}}" }}
{{    range $ri, $rule := index . }}
{{ "{{" }} define "{{ $rule.Name }}" {{ "}}" }}
{{-      if hasTemplate $rule.Name }}
{{-         templateIfExists $rule.Name $rule }}
{{-      else }}
    ## rule: {{ $rule.Name }}
    # file: {{ $rule.OriginalConfig.File }}, lines: {{ index $rule.OriginalConfig.Lines 0 }}-{{ index $rule.OriginalConfig.Lines 1 }}
    #
    # ---8<---8<---8<---8<---8<---
{{      comment $rule.Original 4 }}
    # ---8<---8<---8<---8<---8<---
    #
    ## /rule: {{ $rule.Name }}
{{      end }}
{{- "{{ end }}" }}

{{    end }}
{{ "{{- /*" }}
###
### Defined {{ len . }} iRules.
###
{{ "*/ -}}" }}
{{ end }}

{{ define "export" }}
{{   template "rules" .Cfg.LtmRule }}
{{- end }}
