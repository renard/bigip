{{ define "backend" }}
{{-   $be := index . "backend" }}
{{-   $root := index . "root" }}
backend {{ $be.Name }}
{{-  with $be.Members }}
{{-    range $j, $m := . }}
    server {{ $m.Name }} {{ ipport $m.Name }}
{{-        templateIfExists $m.Name $m }}
{{-    end }}
{{   end }}
{{ end }}

{{ define "pool" }}
{{-   range $i, $backend := index .F5config.LtmPool -}}
{{-     template "block_original" ( dict "block" $backend "type" "pool" "root" $ ) }}
{{-     template "backend" ( dict "backend" $backend "root" $ ) }}
{{-   end }}
{{ end }}
